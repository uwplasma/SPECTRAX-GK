# Physics & Discretizations

## The Vlasov–Poisson System

At its core, **SPECTRAX-GK** solves the **Vlasov–Poisson system** in 1D (space)–1V (velocity) for each plasma species \(s\).

The **Vlasov equation** describes phase-space evolution of the distribution function \(f_s(x,v,t)\):

![Vlasov Eq](https://latex.codecogs.com/svg.image?\frac{\partial%20f_s}{\partial%20t}%20+%20v%20\frac{\partial%20f_s}{\partial%20x}%20+%20\frac{q_s}{m_s}%20E(x,t)\frac{\partial%20f_s}{\partial%20v}%20=%200)

Coupled with **Poisson’s equation** for the electric field:

![Poisson Eq](https://latex.codecogs.com/svg.image?\frac{\partial%20E}{\partial%20x}%20=%20\frac{1}{\epsilon_0}\sum_s%20q_s%20\int%20f_s\,dv)

---

### Physical analogy

- Think of \(f_s(x,v,t)\) as a “cloud” of particles in phase space.
- The **Vlasov equation**:  
  particles move in straight lines (free streaming) but are accelerated by electric fields.
- The **Poisson equation**:  
  the field is self-consistently generated by charge imbalances in that same particle cloud.

This feedback loop drives collective plasma effects: **Landau damping, two-stream instability, bump-on-tail instability**.

---

## Fourier–Hermite Discretization

We expand in Fourier modes (for spatial variation) and Hermite polynomials (for velocity space):

![Expansion](https://latex.codecogs.com/svg.image?f_s(x,v,t)\approx%20f_{0,s}(v)%20+%20\sum_{k,n}%20c_{k,n}^{(s)}(t)\,e^{ikx}\,\phi_n(u),%20\quad%20u=\frac{v-u_{0,s}}{v_{\text{th},s}})

- **Fourier in \(x\):** captures periodic structures like plasma waves.
- **Hermite in \(v\):** efficiently resolves velocity space fine structure.

---

### Operators

The electric field couples through the zeroth Hermite coefficient:

![Ek coupling](https://latex.codecogs.com/svg.image?E_k(t)%20=%20\frac{i}{k\epsilon_0}\sum_s%20q_s%20c_{k,0}^{(s)}(t),%20\quad%20(k\neq%200))

The streaming operator (free particle motion) is **tridiagonal in Hermite index \(n\)**, while the electric field couples Hermite modes across species.

Nonlinearity is handled with a **pseudo-spectral method** in real space:

![Nonlinear term](https://latex.codecogs.com/svg.image?E(x)\,\frac{\partial%20f}{\partial%20v})

with **2/3-rule dealiasing** to maintain spectral accuracy.

---

## Discontinuous Galerkin (DG)–Hermite

Instead of Fourier in \(x\), we can discretize spatial dependence with **discontinuous Galerkin (DG)**:

- Local polynomial expansions in each spatial cell.
- Upwind fluxes handle advection \(v \partial_x f\).
- Periodic BCs by default.

In velocity space we still use Hermite polynomials.  
The **Poisson operator** becomes a matrix \(P\) such that:

![Poisson op](https://latex.codecogs.com/svg.image?E%20=%20P\,\rho)

where \(\rho\) is the charge density projection.

This hybrid **DG–Hermite** scheme is more robust in strongly nonlinear regimes.

---

## Energetics & Diagnostics

We track **kinetic** and **field** energy to ensure conservation and diagnose dynamics.

### Kinetic energy of species \(s\)

![Kinetic energy](https://latex.codecogs.com/svg.image?\mathcal{E}^{(s)}_{\text{kin}}(t)%20=%20\frac{n_{0,s}%20m_s%20v_{\text{th},s}^2}{4\sqrt{2}}\int_0^L%20\left[C_{0}^{(s)}(x,t)%20+%20\sqrt{2}\,C_{2}^{(s)}(x,t)\right]\,dx)

### Field energy

![Field energy](https://latex.codecogs.com/svg.image?\mathcal{E}_{\text{field}}(t)%20=%20\int_0^L%20\frac{E(x,t)^2}{2\epsilon_0}\,dx)

---

## Example Phenomena

- **Landau damping**:  
  Initial perturbation damps due to phase mixing, without collisions.
- **Two-stream instability**:  
  Counter-streaming electron beams excite growing plasma waves.
- **Bump-on-tail**:  
  A superthermal tail destabilizes Langmuir waves.

Each of these is reproducible with SPECTRAX-GK by changing the input `.toml`.

---

## References

- Landau, L. D. *On the vibration of the electronic plasma*. J. Phys. USSR, 1946.  
- Cheng, C. Z., Knorr, G. *Integration of the Vlasov Equation in Configuration Space*. JCP, 1976.  
- Boyd, J. P. *Chebyshev and Fourier Spectral Methods*. Dover, 2001.  
- Shu, C.-W. *Discontinuous Galerkin Methods*. Springer, 2016.
